<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>臼井靈氣十二手式 - 自我療癒計時器</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>臼井靈氣</h1>
            <p class="subtitle">十二手式自我療癒</p>
        </header>

        <div class="setup-screen" id="setupScreen">
            <!-- Mode Selection -->
            <div class="mode-selector">
                <label>療癒模式</label>
                <div class="mode-options">
                    <div class="mode-option selected" data-mode="full" onclick="selectMode('full')">
                        <div class="mode-icon">🙌</div>
                        <div class="mode-info">
                            <div class="mode-name">完整自我療癒</div>
                            <div class="mode-desc">十二手式</div>
                        </div>
                    </div>
                    <div class="mode-option" data-mode="chakra" onclick="selectMode('chakra')">
                        <div class="mode-icon">🌈</div>
                        <div class="mode-info">
                            <div class="mode-name">脈輪啟動</div>
                            <div class="mode-desc">七脈輪</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="time-selector">
                <label>每個手式時間</label>
                <div class="time-row">
                    <div class="time-controls">
                        <button class="time-btn" onclick="adjustMinutes(-1)">−</button>
                        <div class="time-unit">
                            <span class="time-display" id="minutesDisplay">1</span>
                            <span class="time-label">分鐘</span>
                        </div>
                        <button class="time-btn" onclick="adjustMinutes(1)">+</button>
                    </div>
                    <div class="time-controls">
                        <button class="time-btn" onclick="adjustSeconds(-10)">−</button>
                        <div class="time-unit">
                            <span class="time-display" id="secondsDisplay">0</span>
                            <span class="time-label">秒</span>
                        </div>
                        <button class="time-btn" onclick="adjustSeconds(10)">+</button>
                    </div>
                </div>
            </div>

            <!-- Audio Controls -->
            <div class="audio-controls">
                <h3 class="audio-title">音效設定</h3>

                <!-- Bell Sound Control -->
                <div class="audio-control-row">
                    <div class="audio-control-label">
                        <span class="audio-icon">🔔</span>
                        <span>頌缽提示音</span>
                    </div>
                    <div class="audio-control-actions">
                        <button class="toggle-btn" id="bellToggle" onclick="toggleBellSound()">開</button>
                        <button class="preview-btn" onclick="previewBellSound()" title="試聽">▶</button>
                        <div class="volume-control">
                            <input type="range" id="bellVolumeSlider" min="0" max="100" value="80" oninput="setBellVolume(this.value)">
                            <span class="volume-value" id="bellVolumeValue">80%</span>
                        </div>
                    </div>
                </div>

                <!-- Background Music Control -->
                <div class="audio-control-row">
                    <div class="audio-control-label">
                        <span class="audio-icon">🎵</span>
                        <span>背景音樂</span>
                    </div>
                    <div class="audio-control-actions">
                        <button class="toggle-btn off" id="bgMusicToggle" onclick="toggleBgMusic()">關</button>
                    </div>
                </div>

                <!-- Mobile Warning -->
                <div class="mobile-music-warning" id="mobileMusicWarning">
                    <span class="warning-icon">📱</span>
                    <span>手機用戶請注意：播放頌缽聲時會短暫暫停背景音樂，播放完後自動恢復。</span>
                </div>

                <!-- YouTube Embed (hidden by default) -->
                <div class="youtube-embed-container" id="youtubeEmbed" style="display: none;">
                    <p class="embed-hint">背景音樂播放器（療癒時會在下方播放）</p>
                    <iframe
                        id="youtubePlayer"
                        width="100%"
                        height="80"
                        src=""
                        frameborder="0"
                        allow="autoplay; encrypted-media"
                        allowfullscreen>
                    </iframe>
                    <p class="embed-note">提示：開始療癒前請先按播放鍵</p>
                </div>

                <!-- Alternative: Open in new window -->
                <div class="youtube-external" id="youtubeExternal">
                    <button class="open-youtube-btn-small" onclick="openYouTubeMusic()">
                        <svg class="youtube-logo-small" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                        </svg>
                        在新視窗播放音樂
                    </button>
                </div>
            </div>

            <div class="positions-preview">
                <h3 id="positionsPreviewTitle">十二手式</h3>
                <ol class="positions-list" id="positionsPreviewList">
                    <li>前額（第三眼）</li>
                    <li>左右雙耳</li>
                    <li>後腦（後腦勺）</li>
                    <li>喉嚨</li>
                    <li>心臟</li>
                    <li>太陽輪（胃部）</li>
                    <li>臍輪（丹田/腹部）</li>
                    <li>底輪（前面）</li>
                    <li>左右肩膀</li>
                    <li>胃輪（背面）</li>
                    <li>臍輪（背面）</li>
                    <li>底輪（背面）</li>
                </ol>
            </div>

            <button class="start-btn" onclick="startSession()">開始療癒</button>
        </div>

        <div class="timer-screen hidden" id="timerScreen">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="position-info">
                <div class="position-number" id="positionNumber">1 / 12</div>
                <h2 class="position-name" id="positionName">頭頂（百會）</h2>
            </div>

            <!-- Large circle design for desktop/tablet -->
            <div class="timer-circle timer-large-design">
                <svg viewBox="0 0 280 280" class="circle-svg">
                    <circle cx="140" cy="140" r="130" class="circle-bg"></circle>
                    <circle cx="140" cy="140" r="130" class="circle-progress" id="circleProgressLarge"></circle>
                </svg>
                <div class="timer-text" id="timerTextLarge">3:00</div>
            </div>

            <!-- Small circle design for mobile -->
            <div class="timer-display-area timer-small-design">
                <div class="timer-large-text" id="timerTextSmall">3:00</div>
                <div class="timer-circle-small">
                    <svg viewBox="0 0 120 120" class="circle-svg-small">
                        <circle cx="60" cy="60" r="54" class="circle-bg"></circle>
                        <circle cx="60" cy="60" r="54" class="circle-progress" id="circleProgressSmall"></circle>
                    </svg>
                </div>
            </div>

            <div class="controls">
                <button class="control-btn" onclick="pauseTimer()" id="pauseBtn">暫停</button>
                <button class="control-btn secondary" onclick="skipPosition()">跳過</button>
            </div>
            <div class="controls secondary-controls">
                <button class="control-btn secondary" onclick="resetSession()">重新開始</button>
                <button class="control-btn secondary" onclick="backToHome()">回到首頁</button>
            </div>
        </div>

        <div class="completion-screen hidden" id="completionScreen">
            <div class="completion-content">
                <div class="completion-icon">🙏</div>
                <h2>療癒完成</h2>
                <p>願你充滿光與愛</p>
                <button class="start-btn" onclick="resetToSetup()">再次療癒</button>
            </div>
        </div>

        <footer class="attribution">
            <p>頌砵音效：<a href="https://freesound.org/s/476871/" target="_blank" rel="noopener">Bowl Bell #1 by AncientOracle</a> · <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">CC BY 4.0</a></p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
